<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>GrooveMatch ‚Äî Groove Library (Experiment)</title>

  <!-- Fonts should be here, NOT inside <style> -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<style>
 /* assets/groovematch.css ‚Äî GrooveMatch clean scope */
.gm-app{
  --blue:#026bc7; --blue-hov:#025aa6; --blue-act:#014e8f; --blue-100:#e6efff;
  --text:#222; --muted:#667085; --line:#dcdcdc; --bg:#f9fafb; --card:#fff;
  --shadow:0 6px 20px rgba(0,0,0,.06); --radius:12px; --gap:12px;
  font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  color:var(--text); background:var(--bg);
}
.gm-app *, .gm-app *::before, .gm-app *::after{ box-sizing:border-box }

/* Cards */
.gm-app .card,.gm-app .account-card,.gm-app .admin-card{
  background:var(--card); border:1px solid #e6eaf2; border-radius:16px; box-shadow:var(--shadow); padding:14px;
}

/* Buttons (also target plain <button>) */
.gm-app button,.gm-app .btn{
  display:inline-flex; align-items:center; gap:.5rem; padding:.55rem .9rem; line-height:1;
  font-weight:700; border-radius:999px; border:1px solid var(--blue);
  background:#fff; color:var(--blue); cursor:pointer; transition:all .15s ease-in-out;
}
.gm-app button:hover,.gm-app .btn:hover{ background:var(--blue); color:#fff; border-color:var(--blue) }
.gm-app .btn.primary, .gm-app button.primary, .gm-app a.btn.primary{ background:var(--blue); color:#fff; border-color:var(--blue) }
.gm-app .btn.primary:hover, .gm-app button.primary:hover, .gm-app a.btn.primary:hover{ background:var(--blue-hov); border-color:var(--blue-hov) }
.gm-app .btn.outline, .gm-app button.outline, .gm-app a.btn.outline{ background:#fff; color:var(--blue); border:1px solid var(--blue) }
.gm-app .btn.outline:hover, .gm-app button.outline:hover, .gm-app a.btn.outline:hover{ background:var(--blue); color:#fff }

/* Force key actions blue even without .primary */
.gm-app #submitBtn, .gm-app [data-role="submit-groove"], .gm-app [data-action="play"],
.gm-app #results [data-loadslug], .gm-app #results [data-action="load"],
.gm-app #libraryResults [data-loadslug], .gm-app #libraryResults [data-action="load"]{
  background:var(--blue); color:#fff; border-color:var(--blue)
}
.gm-app #submitBtn:hover, .gm-app [data-role="submit-groove"]:hover, .gm-app [data-action="play"]:hover,
.gm-app #results [data-loadslug]:hover, .gm-app #results [data-action="load"]:hover,
.gm-app #libraryResults [data-loadslug]:hover, .gm-app #libraryResults [data-action="load"]:hover{
  background:var(--blue-hov); border-color:var(--blue-hov)
}

/* Inputs + disabled look */
.gm-app input,.gm-app select,.gm-app textarea{ font:inherit; padding:8px 10px; border:1px solid var(--line); border-radius:10px; background:#fff }
.gm-app .form-grid label{ display:flex; flex-direction:column; gap:4px; font-size:14px; text-align:left }
.gm-app .muted-meta input[disabled]{ background:#f3f4f6; color:#6b7280; border:1px solid #e5e7eb; cursor:not-allowed }
.gm-app .muted-meta label{ opacity:.9 }
.gm-app button:focus,.gm-app .btn:focus,.gm-app input:focus,.gm-app select:focus,.gm-app textarea:focus{
  outline-color:var(--blue); box-shadow:0 0 0 2px rgba(2,107,199,.35)
}

/* Header bits */
.gm-app .site-header{ background:#fff; border-bottom:1px solid #eee }
.gm-app .header-inner{ width:min(1100px,100%); margin:0 auto; padding:10px 12px; display:flex; align-items:center; justify-content:space-between; gap:12px }
.gm-app .brand{ display:flex; align-items:center; gap:10px; text-decoration:none }
.gm-app .logo{ height:36px; display:block }
.gm-app .tagline{ font-weight:700; letter-spacing:.2px; color:var(--muted); border-left:1px solid #e5e7eb; padding-left:10px }
.gm-app .header-actions{ display:flex; gap:8px; flex-wrap:wrap; align-items:center }
.gm-app .who{ font-size:12px; color:#6b7280 }

/* App container */
.gm-app .app{ width:min(1100px,100%); margin:28px auto 0; background:#fff; border:1px solid #eee; border-radius:16px; box-shadow:var(--shadow); padding:14px 10px 18px }

/* Builder grid */
.gm-app .system{ display:flex; flex-direction:column; gap:14px; align-items:center; margin-bottom:10px }
@media (min-width:720px){ .gm-app .system{ flex-direction:row; justify-content:center; gap:18px } .gm-app .barline{ display:block } }
.gm-app .barline{ display:none; width:2px; background:#ddd; align-self:stretch; border-radius:2px }
.gm-app .measure{ position:relative; display:flex; flex-direction:column; gap:6px }
.gm-app .cols-dyn{ display:grid; grid-template-columns:var(--cols); gap:var(--gap); width:calc(100% - 20px); margin:0 auto }
.gm-app .row-label .cell{ height:24px; border:1px solid #fff; background:#fff; display:flex; align-items:center; justify-content:center; font-size:12px; color:#666; border-radius:8px }
.gm-app .row .cell{ width:100%; aspect-ratio:1/1; border:1px solid var(--line); border-radius:10px; background:#fff; display:flex; align-items:center; justify-content:center; font-weight:700; font-size:clamp(13px,3.4vw,18px); cursor:pointer; user-select:none; transition:transform .08s ease,background .12s ease,box-shadow .12s ease,outline-color .12s ease; box-shadow:0 1px 0 rgba(0,0,0,.02) }
.gm-app .row .cell.beat-col{ background:var(--blue-100) }
.gm-app .row .cell:hover{ transform:translateY(-1px); box-shadow:0 4px 10px rgba(0,0,0,.06) }
.gm-app .row .cell.playing{ outline:2px solid var(--blue); outline-offset:-2px; background:var(--blue-100) }
.gm-app .row .cell.locked{ opacity:.6 }

/* Plus/minus toggles */
.gm-app .add-mini{ position:absolute; right:-6px; top:-16px; width:22px; height:22px; display:flex; align-items:center; justify-content:center; font:900 14px/1 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; background:#fff; color:var(--blue); border:1px solid var(--blue); border-radius:4px; cursor:pointer; user-select:none; box-shadow:0 1px 4px rgba(0,0,0,.08); z-index:5 }
.gm-app .add-mini:hover{ background:var(--blue-100) }
.gm-app .del-mini{ position:absolute; top:-16px; left:-6px; width:22px; height:22px; display:flex; align-items:center; justify-content:center; font-weight:900; font-size:14px; background:#e11d48; color:#fff; border:none; border-radius:4px; cursor:pointer; user-select:none; box-shadow:0 1px 4px rgba(0,0,0,.08); z-index:5 }
.gm-app .del-mini:hover{ filter:brightness(.95) }

/* Controls & search */
.gm-app #controls, .gm-app #actions { margin:10px 0; display:flex; justify-content:center; align-items:center; gap:10px; flex-wrap:wrap }
.gm-app #sig, .gm-app #tempo, .gm-app #search{ padding:10px 14px; border:1px solid #dcdcdc; border-radius:12px; font-size:15px }
.gm-app #search{ width:min(540px,68vw) }
.gm-app #search:focus{ border-color:#2563eb; box-shadow:0 0 0 3px rgba(37,99,235,.12) }

/* Results cards */
.gm-app #results{ margin-top:12px; font-size:14px; color:#333 }
.gm-app #results .card{ max-width:820px; margin:0 auto 10px; background:#fff; border:1px solid #eaeaea; border-radius:12px; padding:12px }
.gm-app #results .rowline{ display:flex; align-items:center; justify-content:space-between; gap:12px }
.gm-app #results .meta{ color:#555; font-size:12px; margin-top:2px }
.gm-app #results .title{ font-weight:800 }

/* Library */
.gm-app .lib-controls{ display:flex; gap:8px; flex-wrap:wrap; align-items:end; margin:10px 10px 12px; justify-content:center }
.gm-app .lib-controls input,.gm-app .lib-controls select{ padding:8px 10px; border:1px solid #dcdcdc; border-radius:10px }
.gm-app .lib-grid{ display:grid; grid-template-columns:repeat(auto-fill,minmax(240px,1fr)); gap:10px; padding:0 12px 12px }
.gm-app .lib-card{ background:#fff; border:1px solid #eaeaea; border-radius:12px; padding:10px; text-align:left }
.gm-app .lib-meta{ font-size:12px; color:#6b7280 }
.gm-app .lib-actions{ display:flex; gap:8px; margin-top:8px; flex-wrap:wrap }
.gm-app .lib-actions .btn.outline, .gm-app .lib-actions button.outline, .gm-app .lib-actions a.btn.outline{ background:#fff; color:var(--blue); border:1px solid var(--blue) }

/* Toasts */
.gm-app .gm-toast-host{ position:fixed; right:16px; bottom:16px; z-index:99999; display:flex; flex-direction:column; gap:8px; pointer-events:none }
.gm-app .gm-toast{ pointer-events:auto; min-width:220px; max-width:420px; background:#111; color:#fff; border-radius:12px; padding:10px 12px; box-shadow:0 10px 30px rgba(0,0,0,.25); font:600 14px/1.3 Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; display:flex; align-items:center; gap:10px; opacity:0; transform:translateY(8px); transition:opacity .18s ease, transform .18s ease }
.gm-app .gm-toast.info{ background:var(--blue) } .gm-app .gm-toast.ok{ background:#16a34a } .gm-app .gm-toast.warn{ background:#f59e0b } .gm-app .gm-toast.danger{ background:#ef4444 }
.gm-app .gm-toast.show{ opacity:1; transform:translateY(0) }

/* Account */
.gm-app #page-account .account-wrap{ width:min(1000px,100%); margin:14px auto; display:grid; grid-template-columns:1fr; gap:14px }
.gm-app .acct-summary{ display:flex; align-items:center; gap:12px; margin:8px 0 10px }
.gm-app #acctAvatarMini, .gm-app #acctAvatar{ width:72px; height:72px; border-radius:50%; object-fit:cover; background:#fff; border:1px solid #dcdcdc }
.gm-app .acct-name{ font-weight:700 } .gm-app .acct-email{ opacity:.8; font-size:.9rem }
.gm-app .gm-byline, .gm-app .gm-userline{ font-size:12px; opacity:.75; line-height:1.2; margin-top:6px }
.gm-app #page-account .btn.settings{ background:#fff; color:#111; border:1px solid #dcdcdc; border-radius:12px; padding:8px 12px; font-weight:700 }
.gm-app #page-account .btn.settings:hover{ background:var(--blue); color:#fff; border-color:var(--blue) }

/* Admin / Pending */
.gm-app .admin-wrap{ display:grid; grid-template-columns:320px 1fr; gap:14px; align-items:start; padding:14px; height:calc(100vh - 160px) }
.gm-app #adminList{ flex:1 1 auto; overflow:auto; min-height:0; scrollbar-gutter:stable both-edges; overscroll-behavior:contain }
.gm-app #adminList::-webkit-scrollbar{ width:10px } .gm-app #adminList::-webkit-scrollbar-thumb{ background:#cbd5e1; border-radius:8px; border:2px solid #fff } .gm-app #adminList::-webkit-scrollbar-track{ background:#f8fafc; border-radius:8px }

/* Nav order lock */
.gm-app nav, .gm-app header nav, .gm-app .topbar .right, .gm-app .nav{ display:flex }
.gm-app #navAccount{ order:0 !important } .gm-app #navLogout{ order:1 !important }

</style>

 <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
 <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
 <link rel="stylesheet" href="/assets/groovematch.css?v=gm-1">
  
</head>
<body class="gm-app">
  <header class="site-header">
    <div class="header-inner">
      <a class="brand" href="#" id="homeLink" aria-label="GrooveMatch home">
        <img class="logo" src="https://i.imgur.com/QxMCtJj.png" alt="GrooveMatch logo"/>
        <div class="tagline">Find Your Groove</div>
      </a>
      <nav class="header-actions">
        <span id="who" class="who"></span>
        <button id="authBtn" class="btn outline">Log in / Sign up</button>
        <button id="logoutBtn" class="icon-btn" style="display:none">Log out</button>
        <button id="submitBtn" class="btn">Submit Groove</button>
        <button id="libraryBtn" class="btn secondary">Groove Library</button>
        <button id="adminBtn" class="btn outline" style="display:none">Pending Grooves</button>
      </nav>
    </div>
  </header>

  <!-- Login Modal -->
  <div id="loginModal" class="modal" aria-hidden="true" aria-labelledby="loginTitle" role="dialog">
    <div class="modal-backdrop" data-close></div>
    <div class="modal-card" role="document" style="max-width:520px">
      <div class="modal-head">
        <h2 id="loginTitle">Sign in</h2>
        <button class="icon-btn close" data-close aria-label="Close">‚úï</button>
      </div>
      <form id="loginForm" class="modal-body" onsubmit="return false;">
        <div class="grid2" style="grid-template-columns:1fr">
          <label>Email <input id="email" type="email" required></label>
          <label>Password <input id="pass" type="password" required></label>
        </div>
        <div class="modal-actions">
          <button id="doLogin" class="btn">Sign in</button>
        </div>
        <div class="muted" style="margin-top:6px;text-align:left">Demo only: local storage auth for CodePen.</div>
      </form>
    </div>
  </div>

<!-- Submit Groove Modal -->
<div id="submitModal" class="modal" aria-hidden="true" aria-labelledby="submitTitle" role="dialog">
  <div class="modal-backdrop" data-close></div>
  <div class="modal-card" role="document">
    <div class="modal-head">
      <h2 id="submitTitle">Submit Groove</h2>
      <button class="icon-btn close" data-close aria-label="Close">‚úï</button>
    </div>
    <form id="submitForm" class="modal-body">
      <div class="grid3">
        <label>Type
          <select name="type" id="submitType">
            <option value="song" selected>Song</option>
            <option value="pattern">Pattern</option>
          </select>
        </label>
        <label>Time Sig
          <input id="currentSigShow" type="text" disabled />
        </label>
        <label>Tempo
          <input id="currentTempoShow" type="text" disabled />
        </label>
      </div>

      <!-- detail fields wrapper -->
      <div id="detailFields">
        <div class="grid2">
          <label>Artist <input name="artist"></label>
          <label>Song Title <input name="title"></label>
          <label>Drummer <input name="drummer"></label>
          <label>Genre <input name="genre"></label>
        </div>
      </div>

      <div class="modal-actions">
        <button class="btn" type="submit">Send</button>
      </div>
    </form>
  </div>
</div>


  <!-- Thanks Modal -->
  <div id="thanksModal" class="modal" aria-hidden="true" role="alertdialog" aria-labelledby="thanksTitle">
    <div class="modal-backdrop" data-close></div>
    <div class="modal-card" role="document" style="max-width:480px">
      <div class="modal-head">
        <h2 id="thanksTitle">Thanks!</h2>
        <button class="icon-btn close" data-close aria-label="Close">‚úï</button>
      </div>
      <div style="text-align:left; line-height:1.4; padding:6px 2px;">Your groove was submitted and sent to Pending for approval.</div>
      <div class="modal-actions">
        <button class="btn outline" data-close>Close</button>
        <button class="btn" id="openPendingNowBtn">Review Now</button>
      </div>
    </div>
  </div>

  <!-- Builder Page -->
  <section id="page-builder" class="page active">
    <div class="app">
      <img src="https://i.imgur.com/QxMCtJj.png" alt="GrooveMatch" class="logo-center">

      <div class="system" id="system">
        <div class="measure" id="m1">
          <div class="add-mini" id="addBarBtn" title="Add a second measure">+</div>
          <div class="row-label cols-dyn" id="m1-label"></div>
          <div class="row cols-dyn" id="m1-hat"></div>
          <div class="row cols-dyn" id="m1-snare"></div>
          <div class="row cols-dyn" id="m1-kick"></div>
        </div>
        <div class="barline" id="barSep"></div>
        <div class="measure" id="m2" style="display:none">
          <div class="del-mini" id="removeBarBtn" title="Remove second measure">√ó</div>
          <div class="row-label cols-dyn" id="m2-label"></div>
          <div class="row cols-dyn" id="m2-hat"></div>
          <div class="row cols-dyn" id="m2-snare"></div>
          <div class="row cols-dyn" id="m2-kick"></div>
        </div>
      </div>

      <div class="legend">
        <span>x = Closed Hi-Hat</span><span>x> = Accented Hi-Hat</span> <span>O = Open Hi-Hat (locks next step)</span>
        <span>‚óè = Snare / Kick</span><span>(‚óè) = Snare ghost (quieter)</span>
      </div>

      <div id="controls">
        <select id="sig" aria-label="Time Signature">
          <option>2/4</option><option>3/4</option><option selected>4/4</option><option>5/4</option>
          <option>6/8</option><option>7/8</option><option>9/8</option><option>12/8</option>
        </select>
        <label for="tempo">Tempo:</label>
        <input type="number" id="tempo" value="100" min="40" max="240" />
        <button class="btn" id="playBtn" aria-pressed="false">Play</button>
        <button class="icon-btn" id="trashBtn" title="Reset to defaults">üóëÔ∏è</button>
      </div>

      <div id="actions">
        <input id="search" type="text" placeholder="Search songs / artists / drummers‚Ä¶" />
        <button class="btn secondary" id="findBtn">Find Song Examples</button>
      </div>

      <div id="results"></div>
<footer>
   ¬©GrooveMatch 2025 Barret Griffy ‚Ä¢ Built with GPT-5
  <div class="links">
    <a href="#" data-open="tos">Terms of Service</a> ‚Ä¢
    <a href="#" data-open="privacy">Privacy Policy</a> ‚Ä¢
    <a href="#" data-open="how">How to Add Your Grooves</a> ‚Ä¢
    <a href="#" data-open="about">About</a> ‚Ä¢
    <a href="#" data-open="contact">Contact Us</a>
  </div>
 
</footer>
    </div>
  </section>

  <!-- Account Page -->
  <section id="page-account" class="page">
    <div class="account-wrap">
      <div class="account-card">
  <h3 style="margin:6px 0 8px">My Account</h3>
  <div id="acctDisplay" class="muted" style="font-weight:600"></div>
  <div id="acctEmail" class="muted"></div>
  <div id="acctRole" class="muted"></div>
</div>

      <div class="account-card">
        <h3 style="margin:6px 0 8px">My Submissions</h3>
        <div id="mySubs" class="my-list"></div>
      </div>
      <!-- Admin Tools -->
      <div class="account-card" id="adminTools" style="display:none">
        <h3 style="margin:6px 0 8px">Admin Tools</h3>
        <div class="muted" style="margin-bottom:8px">Promote/demote users. (Local demo only.)</div>
        <div style="display:flex;gap:8px;flex-wrap:wrap;margin-bottom:8px">
          <input id="newAdminEmail" placeholder="email to make admin" style="padding:8px 10px;border:1px solid #dcdcdc;border-radius:10px;flex:1;min-width:240px">
          <button id="promoteBtn" class="btn small">Promote</button>
          <button id="demoteBtn" class="btn small outline">Demote</button>
        </div>
        <div id="userList" class="my-list"></div>
      </div>
    </div>
  </section>
  <!-- Admin Pending Page -->
  <section id="page-admin" class="page">
    <div class="admin-wrap">
      <div class="admin-card">
        <div style="display:flex; align-items:center; justify-content:space-between;">
          <h3 style="margin:6px 0 8px">Pending Grooves</h3>
          <button id="backToBuilder" class="icon-btn">‚Üê Back</button>
        </div>
        <div id="adminList" class="admin-list" tabindex="0" aria-label="Pending grooves list (scrollable)"></div>
        <div class="muted" style="margin-top:6px">Only moderators/admins will see this page.</div>
        <h4 style="margin:10px 0 6px; text-align:left">Recent Approvals</h4>
        <div id="approvedCache" class="approved-cache"></div>
      </div>

      <div class="admin-card">
        <h3 style="margin:6px 0 8px">Review & Edit</h3>
        
        <div class="form-grid" style="margin-bottom:10px; display:grid; gap:10px;
  grid-template-columns: repeat(auto-fit, minmax(180px,1fr));">
          <label>Type
            <select id="admType">
              <option value="song">Song</option>
              <option value="pattern">Pattern</option>
            </select>
          </label>
          <label>Title <input id="admTitle"></label>
          <label>Artist <input id="admArtist"></label>
          <label>Drummer <input id="admDrummer"></label>
          <label>Genre <input id="admGenre"></label>
          <label>Time Sig
            <select id="admSig">
              <option>2/4</option><option>3/4</option><option>4/4</option><option>5/4</option>
              <option>6/8</option><option>7/8</option><option>9/8</option><option>12/8</option>
            </select>
          </label>
          <label>Tempo <input type="number" id="admTempo" min="40" max="240"></label>
        </div>

        <div class="system" id="admSystem">
          <div class="measure" id="a1">
            <div class="row-label cols-dyn" id="a1-label"></div>
            <div class="row cols-dyn" id="a1-hat"></div>
            <div class="row cols-dyn" id="a1-snare"></div>
            <div class="row cols-dyn" id="a1-kick"></div>
          </div>
        </div>

        <div class="admin-controls">
          <button class="btn small" id="admPlay">Play</button>
          <button class="btn small outline" id="admStop">Stop</button>
          <button class="btn small outline" id="admSave">Save Changes</button>
          <button class="btn small outline" id="admApprove">Approve</button>
          <button class="btn small outline" id="admReject">Reject</button>
        </div>
      </div>
    </div>
  </section>

  <!-- Groove Library Page -->
  <section id="page-library" class="page">
    <div class="app">
      <h2 style="margin:2px 0 10px">Groove Library</h2>
      <div class="lib-controls">
        <input id="libSearch" placeholder="Search title / artist / drummer‚Ä¶" />
        <select id="libType">
          <option value="all">All</option>
          <option value="song">Songs</option>
          <option value="pattern">Patterns</option>
        </select>
        <select id="libSig">
          <option value="all">Any Sig</option>
          <option>2/4</option><option>3/4</option><option selected>4/4</option><option>5/4</option>
          <option>6/8</option><option>7/8</option><option>9/8</option><option>12/8</option>
        </select>
        <input id="libMin" type="number" placeholder="Min BPM" style="width:110px">
        <input id="libMax" type="number" placeholder="Max BPM" style="width:110px">
        <select id="libSort">
          <option value="new">Newest</option>
          <option value="title">Title</option>
          <option value="tempo">Tempo</option>
        </select>
        <button id="libReset" class="icon-btn">Reset</button>
      </div>
      <div class="lib-grid" id="libGrid"></div>
    </div>
  </section>
  <!-- put this near the end of <body> -->
<script src="/script.js?v=2025-09-04-8" defer></script>
</body>
</html>
