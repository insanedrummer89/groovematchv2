<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>GrooveMatch ‚Äî Groove Library (Experiment)</title>
<style>
  :root{
    --blue:#026bc7; --blue-100:#e6efff; --downbeat:#f3f6ff;
    --line:#dcdcdc; --text:#222; --muted:#667085; --bg:#f9fafb;
    --gap:clamp(2px, 0.6vw, 6px); --radius:10px;
    --card:#fff; --shadow:0 6px 20px rgba(0,0,0,.06);
    --ok:#2ac58b; --warn:#f59e0b; --danger:#ef4444;
  }
  *{box-sizing:border-box}
  body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
       text-align:center;background:var(--bg);color:var(--text);padding:16px}

  .site-header{background:#fff;border-bottom:1px solid #eee}
  .header-inner{width:min(1100px,100%); margin:0 auto; padding:10px 12px;
    display:flex; align-items:center; justify-content:space-between; gap:12px;}
  .brand{display:flex; align-items:center; gap:10px; text-decoration:none}
  .logo{height:36px; display:block}
  .tagline{font-weight:700; letter-spacing:.2px; color:var(--muted); border-left:1px solid #e5e7eb; padding-left:10px}
  .header-actions{display:flex; gap:8px; flex-wrap:wrap; align-items:center}
  .btn{background:var(--blue);color:#fff;border:none;border-radius:12px;padding:10px 16px;font-weight:700;cursor:pointer}
  .btn.outline{background:#fff;color:#111;border:1px solid #dcdcdc}
  .btn.secondary{background:#111}
  .btn.small{padding:8px 10px}
  .icon-btn{background:#fff;border:1px solid #dcdcdc;color:#333;border-radius:10px;padding:8px 10px}
  .icon-btn:active{transform:scale(.98)}
  .who{font-size:12px;color:#6b7280}

  .app{width:min(1100px, 100%);margin:28px auto 0;background:#fff;border:1px solid #eee;border-radius:16px;
    box-shadow:var(--shadow);padding:14px 10px 18px}
  .logo-center{max-width:380px;width:100%;height:auto;display:block;margin:0 auto 14px}

  .system{display:flex;flex-direction:column;gap:14px;align-items:center;margin-bottom:10px}
  @media (min-width: 720px){
    .system{flex-direction:row;justify-content:center;gap:18px}
    .barline{display:block}
  }
  .barline{ display:none; width:2px; background:#ddd; align-self:stretch; border-radius:2px }
  .measure{position:relative;display:flex;flex-direction:column;gap:6px}
  .cols-dyn{display:grid;grid-template-columns:var(--cols);gap:var(--gap);width:calc(100% - 20px);margin:0 auto}
  .row-label .cell{height:24px;border:1px solid #fff;background:#fff;display:flex;align-items:center;justify-content:center;font-size:12px;color:#666;border-radius:8px}
  .row-label .cell.beat{font-weight:900;color:#000}
  .row .cell{width:100%;aspect-ratio:1/1;border:1px solid var(--line);border-radius:var(--radius);
    background:#fff;display:flex;align-items:center;justify-content:center;font-weight:700;
    font-size:clamp(13px,3.4vw,18px);cursor:pointer;user-select:none;transition:transform .08s ease,background .12s ease,box-shadow .12s ease,outline-color .12s ease;
    box-shadow:0 1px 0 rgba(0,0,0,.02)}
  .row .cell.beat-col{background:var(--downbeat)}
  .row .cell:hover{transform:translateY(-1px);box-shadow:0 4px 10px rgba(0,0,0,.06)}
  .row .cell.playing{outline:2px solid var(--blue);outline-offset:-2px;background:var(--blue-100)}
  .row .cell.note{color:#111}
  .row .cell.locked{opacity:.6}
  .add-mini{position:absolute;right:-6px; top:-16px;width:22px;height:22px;display:flex;align-items:center;justify-content:center;
    font:900 14px/1 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:#fff;color:var(--blue);
    border:1px solid var(--blue);border-radius:4px;cursor:pointer;user-select:none;box-shadow:0 1px 4px rgba(0,0,0,.08);z-index:5;}
  .add-mini:hover{ background:var(--blue-100); }
  .del-mini{position:absolute; top:-16px; left:-6px;width:22px;height:22px;display:flex;align-items:center;justify-content:center;
    font-weight:900;font-size:14px;background:#e11d48;color:#fff;border:none;border-radius:4px;cursor:pointer;user-select:none;box-shadow:0 1px 4px rgba(0,0,0,.08);z-index:5;}
  .del-mini:hover{ filter:brightness(0.95); }
  .legend{display:flex;gap:12px;justify-content:center;color:#444;font-size:12px;margin:8px 0 12px;flex-wrap:wrap}
  #controls{margin:10px 0;display:flex;justify-content:center;align-items:center;gap:10px;flex-wrap:wrap}
  #sig{padding:8px 10px;border:1px solid #dcdcdc;border-radius:10px;font-size:14px}
  #tempo{width:86px;padding:8px 10px;border:1px solid #dcdcdc;border-radius:10px}

  #actions{margin:10px 0;display:flex;justify-content:center;align-items:center;gap:10px;flex-wrap:wrap}
  #search{width:min(540px,68vw); padding:10px 14px; border:1px solid #dcdcdc; border-radius:12px; font-size:15px; outline:none}
  #search:focus{border-color:#2563eb; box-shadow:0 0 0 3px rgba(37,99,235,.12)}
  #results{margin-top:12px;font-size:14px;color:#333}
  #results .card{max-width:820px;margin:0 auto 10px;background:#fff;border:1px solid #eaeaea;border-radius:12px;padding:12px}
  #results .rowline{display:flex; align-items:center; justify-content:space-between; gap:12px}
  #results .meta{color:#555; font-size:12px; margin-top:2px}
  #results .title{font-weight:800}

  footer{margin-top:10px;color:#888;font-size:12px}
  footer .links{display:flex; gap:10px; justify-content:center; flex-wrap:wrap; margin-top:8px}
  footer a{color:#6b7280; text-decoration:none; border-bottom:1px dotted #cbd5e1}
  footer a:hover{color:#111}

  #system:not(.two) .measure{ width:100%; }
  #system.two{ display:flex; gap:18px; justify-content:center; align-items:flex-start; }
  #system.two .measure{ width:min(520px,48%); }
  @media (max-width:720px){ #system.two{ flex-direction:column; } #system.two .measure{ width:100%; } }
  #system.two.stack{ flex-direction:column !important; align-items:stretch !important }
  #system.two.stack .measure{ width:100% !important }
  #system.two.stack .barline{ display:none !important }
  .measure.narrow .cols-dyn{ max-width:700px; margin-left:auto; margin-right:auto }

  .page{display:none} .page.active{display:block}

  .admin-wrap{display:grid; grid-template-columns:320px 1fr; gap:14px; align-items:start; padding:14px}
  .admin-card{background:var(--card); border:1px solid #e6eaf2; border-radius:14px; box-shadow:var(--shadow); padding:12px}
  .admin-list{display:grid; gap:8px; max-height:48vh; overflow:auto}
  .admin-item{border:1px solid #ececec; border-radius:10px; padding:10px; text-align:left; cursor:pointer; background:#fff}
  .admin-item:hover{background:#f9fafc}
  .admin-item .t{font-weight:800}
  .admin-item .sub{font-size:12px; color:#6b7280}
  .admin-controls{display:flex; gap:10px; align-items:center; flex-wrap:wrap; margin-top:8px}
  .admin-controls .btn.small{padding:8px 10px}
  .muted{color:#6b7280; font-size:12px}
  .approved-cache{margin-top:10px; max-height:22vh; overflow:auto; display:grid; gap:6px}
  .approved-item{border:1px dashed #e5e7eb; border-radius:10px; padding:8px; text-align:left; font-size:12px; color:#374151; background:#fff}

  .account-wrap{width:min(1000px,100%); margin:14px auto; display:grid; grid-template-columns:1fr; gap:14px; align-items:start}
  .account-card{background:#fff; border:1px solid #e6eaf2; border-radius:14px; box-shadow:var(--shadow); padding:12px; text-align:left}
  .my-list{display:grid; gap:8px}
  .status.badge{display:inline-block; font-size:11px; padding:3px 8px; border:1px solid #e5e7eb; border-radius:999px; background:#f8fafc; margin-left:6px}

  /* Library */
  .lib-controls{display:flex; gap:8px; flex-wrap:wrap; align-items:end; margin:10px 10px 12px; justify-content:center}
  .lib-controls input,.lib-controls select{padding:8px 10px;border:1px solid #dcdcdc;border-radius:10px}
  .lib-grid{display:grid; grid-template-columns:repeat(auto-fill,minmax(240px,1fr)); gap:10px; padding:0 12px 12px}
  .lib-card{background:#fff; border:1px solid #eaeaea; border-radius:12px; padding:10px; text-align:left}
  .lib-card h4{margin:2px 0 6px}
  .lib-meta{font-size:12px; color:#6b7280}
  .lib-actions{display:flex; gap:8px; margin-top:8px; flex-wrap:wrap}
  .chip{display:inline-block; font-size:11px; padding:3px 8px; border:1px solid #e5e7eb; border-radius:999px; background:#f8fafc;}

  /* modal */
  .modal{ position:fixed; inset:0; display:none; z-index:9999 }
  .modal[aria-hidden="false"]{display:block}
  .modal-backdrop{ position:absolute; inset:0; background:rgba(0,0,0,.35) }
  .modal-card{ position:relative; z-index:1; width:min(720px,92vw); margin:6vh auto; background:#fff; border:1px solid #eee; border-radius:14px; box-shadow:0 10px 30px rgba(0,0,0,.18); padding:12px }
  .modal-head{display:flex; align-items:center; justify-content:space-between}
  .modal-body label{display:flex; flex-direction:column; gap:6px; text-align:left; font-size:14px}
  .modal-body input, .modal-body select{padding:8px 10px; border:1px solid #dcdcdc; border-radius:10px; font-size:14px}
  .grid2{display:grid; grid-template-columns:1fr 1fr; gap:10px}
  .grid3{display:grid; grid-template-columns:1fr 1fr 1fr; gap:10px; align-items:end}
  .mini-help{font-size:12px; color:#666}
  .modal-actions{display:flex; justify-content:flex-end; gap:8px; margin-top:12px}
  .icon-btn.close{border:none; background:#fff; font-size:16px; padding:6px 8px}

  @media (max-width:680px){ .grid2,.grid3{grid-template-columns:1fr} .header-inner{flex-direction:column; align-items:flex-start} .header-actions{justify-content:flex-start} }
  
  /* === GM patches === */
.header-actions { display:flex; align-items:center; gap:8px; }
#logoutBtn { margin-left:auto; }           /* shove Logout to the far right */
.who { display:none !important; }          /* hide ‚ÄúSigned in as ‚Ä¶ ¬∑ role‚Äù */
.btn.black { background:#000; color:#fff } /* black button for Groove Library */


/* === GM PATCH v3 === */
.header-actions { display:flex; align-items:center; gap:8px; }
#logoutBtn { margin-left:auto; }
.who { display:none !important; }
#recentApprovals, .recent-approvals, .approvals { max-height:none !important; overflow:visible !important; }

  
  /* Submit Groove: Type + Time Sig + Tempo row */
#submitForm .grid3 { align-items: end; }
#submitForm .grid3 label { text-align:left; font-size:14px; display:flex; flex-direction:column; gap:6px; }

  
/* Match disabled input style to native disabled select */
#submitForm input[disabled],
#submitForm select[disabled] {
  background-color: #f3f4f6;   /* light grey background */
  color: #6b7280;              /* muted text */
  border-color: #d1d5db;       /* softer border */
  cursor: not-allowed;
  opacity: 1;                  /* keep text readable */
}

</style>
</head>
<body>
  <header class="site-header">
    <div class="header-inner">
      <a class="brand" href="#" id="homeLink" aria-label="GrooveMatch home">
        <img class="logo" src="https://i.imgur.com/QxMCtJj.png" alt="GrooveMatch logo"/>
        <div class="tagline">Find Your Groove</div>
      </a>
      <nav class="header-actions">
        <span id="who" class="who"></span>
        <button id="authBtn" class="btn outline">Log in / Sign up</button>
        <button id="logoutBtn" class="icon-btn" style="display:none">Log out</button>
        <button id="submitBtn" class="btn">Submit Groove</button>
        <button id="libraryBtn" class="btn secondary">Groove Library</button>
        <button id="adminBtn" class="btn outline" style="display:none">Pending Grooves</button>
      </nav>
    </div>
  </header>

  <!-- Login Modal -->
  <div id="loginModal" class="modal" aria-hidden="true" aria-labelledby="loginTitle" role="dialog">
    <div class="modal-backdrop" data-close></div>
    <div class="modal-card" role="document" style="max-width:520px">
      <div class="modal-head">
        <h2 id="loginTitle">Sign in</h2>
        <button class="icon-btn close" data-close aria-label="Close">‚úï</button>
      </div>
      <form id="loginForm" class="modal-body" onsubmit="return false;">
        <div class="grid2" style="grid-template-columns:1fr">
          <label>Email <input id="email" type="email" required></label>
          <label>Password <input id="pass" type="password" required></label>
        </div>
        <div class="modal-actions">
          <button id="doLogin" class="btn">Sign in</button>
        </div>
        <div class="muted" style="margin-top:6px;text-align:left">Demo only: local storage auth for CodePen.</div>
      </form>
    </div>
  </div>

<!-- Submit Groove Modal -->
<div id="submitModal" class="modal" aria-hidden="true" aria-labelledby="submitTitle" role="dialog">
  <div class="modal-backdrop" data-close></div>
  <div class="modal-card" role="document">
    <div class="modal-head">
      <h2 id="submitTitle">Submit Groove</h2>
      <button class="icon-btn close" data-close aria-label="Close">‚úï</button>
    </div>
    <form id="submitForm" class="modal-body">
     <div class="grid3">
  <label>Type
    <select name="type" id="submitType">
      <option value="song" selected>Song</option>
      <option value="pattern">Pattern</option>
    </select>
  </label>
  <label>Time Sig
   <input id="currentSigShow" type="text" disabled />
  </label>
  <label>Tempo
    <input id="currentTempoShow" type="text" disabled />
  </label>
</div>
      <!-- detail fields wrapper -->
      <div id="detailFields">
        <div class="grid2">
          <label>Artist <input name="artist" placeholder="Leave blank for patterns"></label>
          <label>Song Title <input name="title"></label>
          <label>Drummer <input name="drummer" placeholder="Optional"></label>
          <label>Genre <input name="genre" placeholder="Optional"></label>
        </div>
      </div>
      <div class="modal-actions">
        <button class="btn" type="submit">Send</button>
      </div>
    </form>
  </div>
</div>

  <!-- Thanks Modal -->
  <div id="thanksModal" class="modal" aria-hidden="true" role="alertdialog" aria-labelledby="thanksTitle">
    <div class="modal-backdrop" data-close></div>
    <div class="modal-card" role="document" style="max-width:480px">
      <div class="modal-head">
        <h2 id="thanksTitle">Thanks!</h2>
        <button class="icon-btn close" data-close aria-label="Close">‚úï</button>
      </div>
      <div style="text-align:left; line-height:1.4; padding:6px 2px;">Your groove was submitted and sent to Pending for approval.</div>
      <div class="modal-actions">
        <button class="btn outline" data-close>Close</button>
        <button class="btn" id="openPendingNowBtn">Review Now</button>
      </div>
    </div>
  </div>

  <!-- Builder Page -->
  <section id="page-builder" class="page active">
    <div class="app">
      <img src="https://i.imgur.com/QxMCtJj.png" alt="GrooveMatch" class="logo-center">

      <div class="system" id="system">
        <div class="measure" id="m1">
          <div class="add-mini" id="addBarBtn" title="Add a second measure">+</div>
          <div class="row-label cols-dyn" id="m1-label"></div>
          <div class="row cols-dyn" id="m1-hat"></div>
          <div class="row cols-dyn" id="m1-snare"></div>
          <div class="row cols-dyn" id="m1-kick"></div>
        </div>
        <div class="barline" id="barSep"></div>
        <div class="measure" id="m2" style="display:none">
          <div class="del-mini" id="removeBarBtn" title="Remove second measure">√ó</div>
          <div class="row-label cols-dyn" id="m2-label"></div>
          <div class="row cols-dyn" id="m2-hat"></div>
          <div class="row cols-dyn" id="m2-snare"></div>
          <div class="row cols-dyn" id="m2-kick"></div>
        </div>
      </div>

      <div class="legend">
        <span>x = Closed Hi-Hat</span><span>x> = Accented Hi-Hat</span> <span>O = Open Hi-Hat (locks next step)</span>
        <span>‚óè = Snare / Kick</span><span>(‚óè) = Snare ghost (quieter)</span>
      </div>

      <div id="controls">
        <select id="sig" aria-label="Time Signature">
          <option>2/4</option><option>3/4</option><option selected>4/4</option><option>5/4</option>
          <option>6/8</option><option>7/8</option><option>9/8</option><option>12/8</option>
        </select>
        <label for="tempo">Tempo:</label>
        <input type="number" id="tempo" value="100" min="40" max="240" />
        <button class="btn" id="playBtn" aria-pressed="false">Play</button>
        <button class="icon-btn" id="trashBtn" title="Reset to defaults">üóëÔ∏è</button>
      </div>

      <div id="actions">
        <input id="search" type="text" placeholder="Search songs / artists / drummers‚Ä¶" />
        <button class="btn secondary" id="findBtn">Find Song Examples</button>
      </div>

      <div id="results"></div>
<footer>
   ¬©GrooveMatch 2025 Barret Griffy ‚Ä¢ Built with GPT-5
  <div class="links">
    <a href="#" data-open="tos">Terms of Service</a> ‚Ä¢
    <a href="#" data-open="privacy">Privacy Policy</a> ‚Ä¢
    <a href="#" data-open="how">How to Add Your Grooves</a> ‚Ä¢
    <a href="#" data-open="about">About</a> ‚Ä¢
    <a href="#" data-open="contact">Contact Us</a>
  </div>
 
</footer>
    </div>
  </section>

  <!-- Account Page -->
  <section id="page-account" class="page">
    <div class="account-wrap">
      <div class="account-card">
  <h3 style="margin:6px 0 8px">My Account</h3>
  <div id="acctDisplay" class="muted" style="font-weight:600"></div>
  <div id="acctEmail" class="muted"></div>
  <div id="acctRole" class="muted"></div>
</div>

      <div class="account-card">
        <h3 style="margin:6px 0 8px">My Submissions</h3>
        <div id="mySubs" class="my-list"></div>
      </div>
      <!-- Admin Tools -->
      <div class="account-card" id="adminTools" style="display:none">
        <h3 style="margin:6px 0 8px">Admin Tools</h3>
        <div class="muted" style="margin-bottom:8px">Promote/demote users. (Local demo only.)</div>
        <div style="display:flex;gap:8px;flex-wrap:wrap;margin-bottom:8px">
          <input id="newAdminEmail" placeholder="email to make admin" style="padding:8px 10px;border:1px solid #dcdcdc;border-radius:10px;flex:1;min-width:240px">
          <button id="promoteBtn" class="btn small">Promote</button>
          <button id="demoteBtn" class="btn small outline">Demote</button>
        </div>
        <div id="userList" class="my-list"></div>
      </div>
    </div>
  </section>

  <!-- Admin Pending Page -->
  <section id="page-admin" class="page">
    <div class="admin-wrap">
      <div class="admin-card">
        <div style="display:flex; align-items:center; justify-content:space-between;">
          <h3 style="margin:6px 0 8px">Pending Grooves</h3>
          <button id="backToBuilder" class="icon-btn">‚Üê Back</button>
        </div>
        <div id="adminList" class="admin-list" tabindex="0" aria-label="Pending grooves list (scrollable)"></div>
        <div class="muted" style="margin-top:6px">Only moderators/admins will see this page.</div>
        <h4 style="margin:10px 0 6px; text-align:left">Recent Approvals</h4>
        <div id="approvedCache" class="approved-cache"></div>
      </div>

      <div class="admin-card">
        <h3 style="margin:6px 0 8px">Review & Edit</h3>
        
        <div class="form-grid" style="margin-bottom:10px; display:grid; gap:10px;
  grid-template-columns: repeat(auto-fit, minmax(180px,1fr));">
          <label>Type
            <select id="admType">
              <option value="song">Song</option>
              <option value="pattern">Pattern</option>
            </select>
          </label>
          <label>Title <input id="admTitle"></label>
          <label>Artist <input id="admArtist"></label>
          <label>Drummer <input id="admDrummer"></label>
          <label>Genre <input id="admGenre"></label>
          <label>Time Sig
            <select id="admSig">
              <option>2/4</option><option>3/4</option><option>4/4</option><option>5/4</option>
              <option>6/8</option><option>7/8</option><option>9/8</option><option>12/8</option>
            </select>
          </label>
          <label>Tempo <input type="number" id="admTempo" min="40" max="240"></label>
        </div>

        <div class="system" id="admSystem">
          <div class="measure" id="a1">
            <div class="row-label cols-dyn" id="a1-label"></div>
            <div class="row cols-dyn" id="a1-hat"></div>
            <div class="row cols-dyn" id="a1-snare"></div>
            <div class="row cols-dyn" id="a1-kick"></div>
          </div>
        </div>

        <div class="admin-controls">
          <button class="btn small" id="admPlay">Play</button>
          <button class="btn small outline" id="admStop">Stop</button>
          <button class="btn small outline" id="admSave">Save Changes</button>
          <button class="btn small outline" id="admApprove">Approve</button>
          <button class="btn small outline" id="admReject">Reject</button>
        </div>
      </div>
    </div>
  </section>

  <!-- Groove Library Page -->
  <section id="page-library" class="page">
    <div class="app">
      <h2 style="margin:2px 0 10px">Groove Library</h2>
      <div class="lib-controls">
        <input id="libSearch" placeholder="Search title / artist / drummer‚Ä¶" />
        <select id="libType">
          <option value="all">All</option>
          <option value="song">Songs</option>
          <option value="pattern">Patterns</option>
        </select>
        <select id="libSig">
          <option value="all">Any Sig</option>
          <option>2/4</option><option>3/4</option><option selected>4/4</option><option>5/4</option>
          <option>6/8</option><option>7/8</option><option>9/8</option><option>12/8</option>
        </select>
        <input id="libMin" type="number" placeholder="Min BPM" style="width:110px">
        <input id="libMax" type="number" placeholder="Max BPM" style="width:110px">
        <select id="libSort">
          <option value="new">Newest</option>
          <option value="title">Title</option>
          <option value="tempo">Tempo</option>
        </select>
        <button id="libReset" class="icon-btn">Reset</button>
      </div>
      <div class="lib-grid" id="libGrid"></div>
    </div>
  </section>
  <!-- put this near the end of <body> -->
<script src="/script.js?v=2025-09-04-8" defer></script>
  </body>
</html>
